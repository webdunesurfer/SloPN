services:
  slopn-server:
    build: .
    container_name: slopn-server
    restart: unless-stopped
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun:/dev/net/tun
    ports:
      - "4242:4242/udp"
    environment:
      - SLOPN_TOKEN=secret-token
      - SLOPN_NAT=true
      - SLOPN_VERBOSE=false
      - SLOPN_MAX_ATTEMPTS=5
      - SLOPN_WINDOW=5
      - SLOPN_BAN_DURATION=60
    command: ["-nat", "-token", "your-secret-token"]
    # We may need privileged mode for some sysctl if cap_add is not enough
    # privileged: true
